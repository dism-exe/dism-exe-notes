/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toESM = (mod, isNodeMode, target) => (target = mod != null ? __create(__getProtoOf(mod)) : {}, __copyProps(
  // If the importer is in node compatibility mode or this is not an ESM
  // file that has been converted to a CommonJS file using a Babel-
  // compatible transform (i.e. "__esModule" has not been set), then set
  // "default" to the CommonJS "module.exports" for node compatibility.
  isNodeMode || !mod || !mod.__esModule ? __defProp(target, "default", { value: mod, enumerable: true }) : target,
  mod
));
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// src/main.ts
var main_exports = {};
__export(main_exports, {
  default: () => LanPlugin
});
module.exports = __toCommonJS(main_exports);
var import_obsidian4 = require("obsidian");

// src/spawn_peripheral_note_command.ts
var import_obsidian3 = require("obsidian");
var path = __toESM(require("path"));

// src/notecluster.ts
var import_obsidian2 = require("obsidian");

// src/common.ts
var import_obsidian = require("obsidian");
function make_hex_id(length) {
  var result = "";
  var characters = "abcdef0123456789";
  var charactersLength = characters.length;
  for (var i = 0; i < length; i++) {
    result += characters.charAt(Math.floor(Math.random() * charactersLength));
  }
  return result;
}
function get_file_frontmatter_note_property(view, file, prop) {
  const opt_cache = view.app.metadataCache.getFileCache(file);
  if (!opt_cache) {
    console.log(`Error: Could not retrieve file cache for ${file.name}`);
    return void 0;
  }
  const cache = opt_cache;
  const opt_frontmatter = cache.frontmatter;
  if (!opt_frontmatter) {
    console.log(`Error: Could not retrieve frontmatter for ${file.name}`);
    return void 0;
  }
  const frontmatter = opt_frontmatter;
  const opt_value = frontmatter[prop];
  if (!opt_value) {
    console.log(`Error: Could not retrieve frontmatter property ${prop} for ${file.name}`);
    return void 0;
  }
  const value = opt_value.replace("[[", "").replace("]]", "");
  const opt_linked_file = file.vault.getMarkdownFiles().find((f) => f.basename === value);
  if (!opt_linked_file) {
    console.log(`Error: Could not find file for link ${value}`);
    return void 0;
  }
  return opt_linked_file;
}
function insert_text_at_editor_cursor_in_own_line(editor, text) {
  const cursor = editor.getCursor();
  editor.replaceRange("\n" + text + "\n", cursor);
}
function get_child_folder_by_name(folder, child_name) {
  for (var i = 0; i < folder.children.length; i++) {
    const child = folder.children[i];
    if (child instanceof import_obsidian.TFolder && child.name === child_name) {
      return child;
    }
  }
  return void 0;
}
function get_folder_child_file_count_non_recursive(folder) {
  var count = 0;
  for (var i = 0; i < folder.children.length; i++) {
    const child = folder.children[i];
    if (child instanceof import_obsidian.TFile) {
      count++;
    }
  }
  return count;
}

// src/notecluster.ts
var CONTEXT_TYPE_FOLDERS = [
  "entries",
  "howtos",
  "ideas",
  "inferences",
  "investigations",
  "issues",
  "tasks"
];
var CONTEXT_TYPE_BLOCK_IDENTIFIER_CODE = [
  "entry",
  "howto",
  "idea",
  "infer",
  "invst",
  "issue",
  "task"
];
var CONTEXT_TYPE_HEADINGS_SINGULAR = [
  "Entry",
  "HowTo",
  "Idea",
  "Inference",
  "Investigation",
  "Issue",
  "Task"
];
function context_type_singular_convert(context_type, new_type_strings) {
  const index = CONTEXT_TYPE_HEADINGS_SINGULAR.findIndex((elem) => elem === context_type);
  if (index == -1) {
    return void 0;
  }
  if (index < 0 || index >= new_type_strings.length) {
    console.log(
      `Error: Unexpected value for ${index} for context type lookup`
    );
    return void 0;
  }
  return new_type_strings[index];
}
function context_type_heading_singular_is_doer(heading) {
  const doers = [
    // "Entry",
    "HowTo",
    // "Idea",
    // "Inference",
    "Investigation",
    "Issue",
    "Task"
  ];
  return doers.contains(heading);
}
function folder_has_note_of_same_name(folder) {
  for (var i = 0; i < folder.children.length; i++) {
    const child = folder.children[i];
    if (child instanceof import_obsidian2.TFile) {
      if (folder.name == child.basename) {
        return true;
      }
    }
  }
  return false;
}
function is_cluster_root_folder(folder) {
  if (!folder_has_note_of_same_name(folder) || get_folder_child_file_count_non_recursive(folder) != 1) {
    return false;
  }
  return true;
}
function is_cluster_category_folder(folder) {
  if (!CONTEXT_TYPE_FOLDERS.includes(folder.name)) {
    return false;
  }
  const opt_parent = folder.parent;
  if (!opt_parent) {
    return false;
  }
  const parent = opt_parent;
  if (!is_cluster_root_folder(parent)) {
    return false;
  }
  return true;
}
function is_cluster_root_file(file) {
  const opt_parent = file.parent;
  if (!opt_parent) {
    return false;
  }
  const parent = opt_parent;
  if (!is_cluster_root_folder(parent)) {
    return false;
  }
  if (parent.name != file.basename) {
    return false;
  }
  return true;
}
function get_cluster_core_file_from_peripheral(view, peripheral_file) {
  const opt_parent_file = get_file_frontmatter_note_property(
    view,
    peripheral_file,
    "parent"
  );
  if (!opt_parent_file) {
    console.log(`Error: Could not retrieve frontmatter note property parent for ${peripheral_file.name}`);
    return void 0;
  }
  const parent_file = opt_parent_file;
  if (!is_cluster_root_file(parent_file)) {
    console.log(`Error: ${parent_file.name} is not a bignote index file`);
    return void 0;
  }
  return parent_file;
}
function get_cluster_core_file_from_cluster_root_folder(folder) {
  if (!is_cluster_root_folder(folder)) {
    console.log(`Error: Expected ${folder.name} to be a bignote root folder`);
    return void 0;
  }
  for (var i = 0; i < folder.children.length; i++) {
    const child = folder.children[i];
    if (child instanceof import_obsidian2.TFile && child.basename == folder.name) {
      return child;
    }
  }
  console.log(`Assertion Failed: No index file found in bignote root folder`);
  return void 0;
}
function is_cluster_non_index_file(view, file) {
  const opt_parent = file.parent;
  if (!opt_parent) {
    console.log(`Error: Failed to retrieve parent folder for ${file.name}`);
    return false;
  }
  const parent_folder = opt_parent;
  if (!is_cluster_category_folder(parent_folder)) {
    console.log(`Error: ${parent_folder.name} is not a bignote category folder`);
    return false;
  }
  const opt_parent_file = get_cluster_core_file_from_peripheral(view, file);
  if (!opt_parent_file) {
    console.log(`Error: Could not get big note index file for ${file.name}`);
    return false;
  }
  const parent_file = opt_parent_file;
  const opt_grandparent_folder = parent_folder.parent;
  if (!opt_grandparent_folder) {
    console.log(`Error: Could not get grandparent for ${file.name}`);
    return false;
  }
  const grandparent_folder = opt_grandparent_folder;
  if (grandparent_folder != parent_file.parent) {
    console.log(`Error: Expected grandparent ${grandparent_folder.name} to be identical to parent folder of ${parent_file.path}`);
    return false;
  }
  return true;
}
function display_triplet_id(id) {
  if (id < 10) {
    return "00" + id.toString();
  } else if (id < 100) {
    return "0" + id.toString();
  } else {
    return id.toString();
  }
}
function get_next_triplet_id_for_folder(context_folder_name, index_file) {
  if (!CONTEXT_TYPE_FOLDERS.includes(context_folder_name)) {
    return void 0;
  }
  const opt_bignote_root_folder = index_file.parent;
  if (!opt_bignote_root_folder) {
    return void 0;
  }
  const bignote_root_folder = opt_bignote_root_folder;
  const opt_context_folder = get_child_folder_by_name(bignote_root_folder, context_folder_name);
  if (!opt_context_folder) {
    return void 0;
  }
  const context_folder = opt_context_folder;
  const num_files_in_context_folder = get_folder_child_file_count_non_recursive(context_folder);
  return display_triplet_id(num_files_in_context_folder);
}
function get_all_index_folders_in_vault(view) {
  const folders = view.app.vault.getAllFolders(false).filter((folder) => is_cluster_root_folder(folder));
  return folders;
}

// src/spawn_peripheral_note_command.ts
async function run_with_user_input(editor, view, opt_selected_bignote_root_folder, selected_context, new_note_name) {
  const opt_spawner_file = view.file;
  if (!opt_spawner_file) {
    new import_obsidian3.Notice(`Error: Please use this command from within a note to spawn from`);
    return;
  }
  const spawner_file = opt_spawner_file;
  const spawner_is_index = is_cluster_root_file(spawner_file);
  if (!spawner_is_index && !opt_selected_bignote_root_folder && !is_cluster_non_index_file(view, spawner_file)) {
    new import_obsidian3.Notice(`Error: Spawner file is not a small note`);
    return;
  }
  var opt_index_file = void 0;
  if (spawner_is_index) {
    opt_index_file = spawner_file;
  } else if (opt_selected_bignote_root_folder) {
    opt_index_file = get_cluster_core_file_from_cluster_root_folder(opt_selected_bignote_root_folder);
  } else {
    opt_index_file = get_cluster_core_file_from_peripheral(view, spawner_file);
  }
  if (!opt_index_file) {
    new import_obsidian3.Notice(`Error: Failed to retrieve index file`);
    return;
  }
  const index_file = opt_index_file;
  const opt_bignote_root_folder = index_file.parent;
  if (!opt_bignote_root_folder) {
    new import_obsidian3.Notice(`Failed Assertion: index file has no parent`);
    return;
  }
  const bignote_root_folder = opt_bignote_root_folder;
  const opt_context_folder_name = context_type_singular_convert(selected_context, CONTEXT_TYPE_FOLDERS);
  if (!opt_context_folder_name) {
    new import_obsidian3.Notice(`Error: Failed to retrieve context folder`);
    return;
  }
  const context_folder_name = opt_context_folder_name;
  const opt_context_block_identifier_code = context_type_singular_convert(selected_context, CONTEXT_TYPE_BLOCK_IDENTIFIER_CODE);
  if (!opt_context_block_identifier_code) {
    new import_obsidian3.Notice(`Error: Failed to retrieve context block identifier code`);
    return;
  }
  const context_block_identifier_code = opt_context_block_identifier_code;
  const context_folder_path = (0, import_obsidian3.normalizePath)(path.join(bignote_root_folder.path, context_folder_name));
  const fs = spawner_file.vault.adapter;
  console.log(`context_folder_path: ${context_folder_path}`);
  await fs.mkdir(context_folder_path);
  const id6 = make_hex_id(6);
  const opt_triplet_id = get_next_triplet_id_for_folder(context_folder_name, index_file);
  if (!opt_triplet_id) {
    new import_obsidian3.Notice(`Error: Failed to generate new triplet id`);
    return;
  }
  const triplet_id = opt_triplet_id;
  const new_note_basename = `${triplet_id} ${new_note_name}`;
  const block_identifier = `^spawn-${context_block_identifier_code}-${id6}`;
  insert_text_at_editor_cursor_in_own_line(editor, `Spawn [[${new_note_basename}]] ${block_identifier}`);
  const new_file_path = (0, import_obsidian3.normalizePath)(path.join(context_folder_path, new_note_basename + ".md"));
  console.log(`new_file_path: ${new_file_path}`);
  var automatic_status = "";
  if (context_type_heading_singular_is_doer(selected_context)) {
    automatic_status = `status: todo
`;
  }
  var context_type = selected_context.toLowerCase();
  await fs.write(
    new_file_path,
    `---
parent: "[[${index_file.basename}]]"
spawned_by: "[[${spawner_file.basename}]]"
context_type: ${context_type}
` + automatic_status + `---

Parent: [[${index_file.basename}]]

Spawned by: [[${spawner_file.basename}]] 

Spawned in: [[${spawner_file.basename}#${block_identifier}|${block_identifier}]]

# Journal`
  );
}
var InputNoteNameModal = class extends import_obsidian3.Modal {
  constructor(app, onSubmit) {
    super(app);
    this.setTitle("New Note Name (without NNN ID)");
    let name = "";
    new import_obsidian3.Setting(this.contentEl).setName("New Note Name").addText(
      (text) => text.onChange((value) => {
        name = value;
      })
    );
    new import_obsidian3.Setting(this.contentEl).addButton(
      (btn) => btn.setButtonText("Submit").setCta().onClick(() => {
        this.close();
        onSubmit(name);
      })
    );
  }
};
var SelectContextTypeModal = class extends import_obsidian3.FuzzySuggestModal {
  constructor(app, editor, view, opt_selected_index_folder) {
    super(app);
    this.editor = editor;
    this.view = view;
    this.opt_selected_bignote_root_folder = opt_selected_index_folder;
  }
  getItems() {
    return CONTEXT_TYPE_HEADINGS_SINGULAR;
  }
  getItemText(item) {
    return item;
  }
  onChooseItem(item, evt) {
    new InputNoteNameModal(this.app, (result) => {
      run_with_user_input(this.editor, this.view, this.opt_selected_bignote_root_folder, item, result);
    }).open();
  }
};
var SelectBignoteRootFolderModal = class extends import_obsidian3.FuzzySuggestModal {
  constructor(app, editor, view) {
    super(app);
    this.editor = editor;
    this.view = view;
  }
  getItems() {
    return get_all_index_folders_in_vault(this.view);
  }
  getItemText(item) {
    return item.name;
  }
  onChooseItem(item, evt) {
    new SelectContextTypeModal(
      this.view.app,
      this.editor,
      this.view,
      /*opt_selected_bignote_root_folder*/
      item
    ).open();
  }
};
async function run(editor, view) {
  new SelectContextTypeModal(
    view.app,
    editor,
    view,
    /*opt_selected_bignote_root_folder*/
    void 0
  ).open();
}
async function run_from_outside(editor, view) {
  new SelectBignoteRootFolderModal(view.app, editor, view).open();
}

// src/main.ts
var DEFAULT_SETTINGS = {
  mySetting: "default"
};
var LanPlugin = class extends import_obsidian4.Plugin {
  async onload() {
    await this.loadSettings();
    const ribbonIconEl = this.addRibbonIcon(
      "dice",
      "Sample Plugin",
      (evt) => {
        new import_obsidian4.Notice("This is a notice!");
      }
    );
    ribbonIconEl.addClass("my-plugin-ribbon-class");
    const statusBarItemEl = this.addStatusBarItem();
    statusBarItemEl.setText("Status Bar Text");
    this.addCommand({
      id: "open-sample-modal-simple",
      name: "Open sample modal (simple)",
      callback: () => {
        new SampleModal(this.app).open();
      }
    });
    this.addCommand({
      id: "sample-editor-command",
      name: "Sample editor command",
      editorCallback: (editor, view) => {
        console.log(editor.getSelection());
        editor.replaceSelection("Plugin typed a message!");
      }
    });
    this.addCommand({
      id: "open-sample-modal-complex",
      name: "Open sample modal (complex)",
      checkCallback: (checking) => {
        const markdownView = this.app.workspace.getActiveViewOfType(import_obsidian4.MarkdownView);
        if (markdownView) {
          if (!checking) {
            new SampleModal(this.app).open();
          }
          return true;
        }
      }
    });
    this.addCommand({
      id: "spawn-peripheral-note",
      name: "Spawn Peripheral Note",
      editorCallback: run
    });
    this.addCommand({
      id: "spawn-peripheral-note-from-outside",
      name: "Spawn Peripheral Note From Outside",
      editorCallback: run_from_outside
    });
    this.addSettingTab(new SampleSettingTab(this.app, this));
    this.registerDomEvent(document, "click", (evt) => {
      console.log("click", evt);
    });
    this.registerInterval(
      window.setInterval(() => console.log("setInterval"), 5 * 60 * 1e3)
    );
  }
  onunload() {
  }
  async loadSettings() {
    this.settings = Object.assign(
      {},
      DEFAULT_SETTINGS,
      await this.loadData()
    );
  }
  async saveSettings() {
    await this.saveData(this.settings);
  }
};
var SampleModal = class extends import_obsidian4.Modal {
  constructor(app) {
    super(app);
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.setText("Woah!");
  }
  onClose() {
    const { contentEl } = this;
    contentEl.empty();
  }
};
var SampleSettingTab = class extends import_obsidian4.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    new import_obsidian4.Setting(containerEl).setName("Setting #1").setDesc("It's a secret").addText(
      (text) => text.setPlaceholder("Enter your secret").setValue(this.plugin.settings.mySetting).onChange(async (value) => {
        this.plugin.settings.mySetting = value;
        await this.plugin.saveSettings();
      })
    );
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsic3JjL21haW4udHMiLCAic3JjL3NwYXduX3BlcmlwaGVyYWxfbm90ZV9jb21tYW5kLnRzIiwgInNyYy9ub3RlY2x1c3Rlci50cyIsICJzcmMvY29tbW9uLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQge1xuXHRBcHAsXG5cdEVkaXRvcixcblx0TWFya2Rvd25WaWV3LFxuXHRNb2RhbCxcblx0Tm90aWNlLFxuXHRQbHVnaW4sXG5cdFBsdWdpblNldHRpbmdUYWIsXG5cdFNldHRpbmcsXG59IGZyb20gXCJvYnNpZGlhblwiO1xuXG5pbXBvcnQgKiBhcyBzcGF3bl9ub3RlX2NvbW1hbmQgZnJvbSBcIi4vc3Bhd25fcGVyaXBoZXJhbF9ub3RlX2NvbW1hbmRcIjtcblxuLy8gUmVtZW1iZXIgdG8gcmVuYW1lIHRoZXNlIGNsYXNzZXMgYW5kIGludGVyZmFjZXMhXG5cbmludGVyZmFjZSBMYW5QbHVnaW5TZXR0aW5ncyB7XG5cdG15U2V0dGluZzogc3RyaW5nO1xufVxuXG5jb25zdCBERUZBVUxUX1NFVFRJTkdTOiBMYW5QbHVnaW5TZXR0aW5ncyA9IHtcblx0bXlTZXR0aW5nOiBcImRlZmF1bHRcIixcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIExhblBsdWdpbiBleHRlbmRzIFBsdWdpbiB7XG5cdHNldHRpbmdzOiBMYW5QbHVnaW5TZXR0aW5ncztcblxuXHRhc3luYyBvbmxvYWQoKSB7XG5cdFx0YXdhaXQgdGhpcy5sb2FkU2V0dGluZ3MoKTtcblxuXHRcdC8vIFRoaXMgY3JlYXRlcyBhbiBpY29uIGluIHRoZSBsZWZ0IHJpYmJvbi5cblx0XHRjb25zdCByaWJib25JY29uRWwgPSB0aGlzLmFkZFJpYmJvbkljb24oXG5cdFx0XHRcImRpY2VcIixcblx0XHRcdFwiU2FtcGxlIFBsdWdpblwiLFxuXHRcdFx0KGV2dDogTW91c2VFdmVudCkgPT4ge1xuXHRcdFx0XHQvLyBDYWxsZWQgd2hlbiB0aGUgdXNlciBjbGlja3MgdGhlIGljb24uXG5cdFx0XHRcdG5ldyBOb3RpY2UoXCJUaGlzIGlzIGEgbm90aWNlIVwiKTtcblx0XHRcdH1cblx0XHQpO1xuXG5cdFx0Ly8gUGVyZm9ybSBhZGRpdGlvbmFsIHRoaW5ncyB3aXRoIHRoZSByaWJib25cblx0XHRyaWJib25JY29uRWwuYWRkQ2xhc3MoXCJteS1wbHVnaW4tcmliYm9uLWNsYXNzXCIpO1xuXG5cdFx0Ly8gVGhpcyBhZGRzIGEgc3RhdHVzIGJhciBpdGVtIHRvIHRoZSBib3R0b20gb2YgdGhlIGFwcC4gRG9lcyBub3Qgd29yayBvbiBtb2JpbGUgYXBwcy5cblx0XHRjb25zdCBzdGF0dXNCYXJJdGVtRWwgPSB0aGlzLmFkZFN0YXR1c0Jhckl0ZW0oKTtcblx0XHRzdGF0dXNCYXJJdGVtRWwuc2V0VGV4dChcIlN0YXR1cyBCYXIgVGV4dFwiKTtcblxuXHRcdC8vIFRoaXMgYWRkcyBhIHNpbXBsZSBjb21tYW5kIHRoYXQgY2FuIGJlIHRyaWdnZXJlZCBhbnl3aGVyZVxuXHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRpZDogXCJvcGVuLXNhbXBsZS1tb2RhbC1zaW1wbGVcIixcblx0XHRcdG5hbWU6IFwiT3BlbiBzYW1wbGUgbW9kYWwgKHNpbXBsZSlcIixcblx0XHRcdGNhbGxiYWNrOiAoKSA9PiB7XG5cdFx0XHRcdG5ldyBTYW1wbGVNb2RhbCh0aGlzLmFwcCkub3BlbigpO1xuXHRcdFx0fSxcblx0XHR9KTtcblxuXHRcdC8vIFRoaXMgYWRkcyBhbiBlZGl0b3IgY29tbWFuZCB0aGF0IGNhbiBwZXJmb3JtIHNvbWUgb3BlcmF0aW9uIG9uIHRoZSBjdXJyZW50IGVkaXRvciBpbnN0YW5jZVxuXHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRpZDogXCJzYW1wbGUtZWRpdG9yLWNvbW1hbmRcIixcblx0XHRcdG5hbWU6IFwiU2FtcGxlIGVkaXRvciBjb21tYW5kXCIsXG5cdFx0XHRlZGl0b3JDYWxsYmFjazogKGVkaXRvcjogRWRpdG9yLCB2aWV3OiBNYXJrZG93blZpZXcpID0+IHtcblx0XHRcdFx0Y29uc29sZS5sb2coZWRpdG9yLmdldFNlbGVjdGlvbigpKTtcblx0XHRcdFx0ZWRpdG9yLnJlcGxhY2VTZWxlY3Rpb24oXCJQbHVnaW4gdHlwZWQgYSBtZXNzYWdlIVwiKTtcblx0XHRcdH0sXG5cdFx0fSk7XG5cblx0XHQvLyBUaGlzIGFkZHMgYSBjb21wbGV4IGNvbW1hbmQgdGhhdCBjYW4gY2hlY2sgd2hldGhlciB0aGUgY3VycmVudCBzdGF0ZSBvZiB0aGUgYXBwIGFsbG93cyBleGVjdXRpb24gb2YgdGhlIGNvbW1hbmRcblx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0aWQ6IFwib3Blbi1zYW1wbGUtbW9kYWwtY29tcGxleFwiLFxuXHRcdFx0bmFtZTogXCJPcGVuIHNhbXBsZSBtb2RhbCAoY29tcGxleClcIixcblx0XHRcdGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xuXHRcdFx0XHQvLyBDb25kaXRpb25zIHRvIGNoZWNrXG5cdFx0XHRcdGNvbnN0IG1hcmtkb3duVmlldyA9XG5cdFx0XHRcdFx0dGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcblx0XHRcdFx0aWYgKG1hcmtkb3duVmlldykge1xuXHRcdFx0XHRcdC8vIElmIGNoZWNraW5nIGlzIHRydWUsIHdlJ3JlIHNpbXBseSBcImNoZWNraW5nXCIgaWYgdGhlIGNvbW1hbmQgY2FuIGJlIHJ1bi5cblx0XHRcdFx0XHQvLyBJZiBjaGVja2luZyBpcyBmYWxzZSwgdGhlbiB3ZSB3YW50IHRvIGFjdHVhbGx5IHBlcmZvcm0gdGhlIG9wZXJhdGlvbi5cblx0XHRcdFx0XHRpZiAoIWNoZWNraW5nKSB7XG5cdFx0XHRcdFx0XHRuZXcgU2FtcGxlTW9kYWwodGhpcy5hcHApLm9wZW4oKTtcblx0XHRcdFx0XHR9XG5cblx0XHRcdFx0XHQvLyBUaGlzIGNvbW1hbmQgd2lsbCBvbmx5IHNob3cgdXAgaW4gQ29tbWFuZCBQYWxldHRlIHdoZW4gdGhlIGNoZWNrIGZ1bmN0aW9uIHJldHVybnMgdHJ1ZVxuXHRcdFx0XHRcdHJldHVybiB0cnVlO1xuXHRcdFx0XHR9XG5cdFx0XHR9LFxuXHRcdH0pO1xuXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdGlkOiBcInNwYXduLXBlcmlwaGVyYWwtbm90ZVwiLFxuXHRcdFx0bmFtZTogXCJTcGF3biBQZXJpcGhlcmFsIE5vdGVcIixcblx0XHRcdGVkaXRvckNhbGxiYWNrOiBzcGF3bl9ub3RlX2NvbW1hbmQucnVuLFxuXHRcdH0pO1xuXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdGlkOiBcInNwYXduLXBlcmlwaGVyYWwtbm90ZS1mcm9tLW91dHNpZGVcIixcblx0XHRcdG5hbWU6IFwiU3Bhd24gUGVyaXBoZXJhbCBOb3RlIEZyb20gT3V0c2lkZVwiLFxuXHRcdFx0ZWRpdG9yQ2FsbGJhY2s6IHNwYXduX25vdGVfY29tbWFuZC5ydW5fZnJvbV9vdXRzaWRlLFxuXHRcdH0pO1xuXG5cdFx0Ly8gVGhpcyBhZGRzIGEgc2V0dGluZ3MgdGFiIHNvIHRoZSB1c2VyIGNhbiBjb25maWd1cmUgdmFyaW91cyBhc3BlY3RzIG9mIHRoZSBwbHVnaW5cblx0XHR0aGlzLmFkZFNldHRpbmdUYWIobmV3IFNhbXBsZVNldHRpbmdUYWIodGhpcy5hcHAsIHRoaXMpKTtcblxuXHRcdC8vIElmIHRoZSBwbHVnaW4gaG9va3MgdXAgYW55IGdsb2JhbCBET00gZXZlbnRzIChvbiBwYXJ0cyBvZiB0aGUgYXBwIHRoYXQgZG9lc24ndCBiZWxvbmcgdG8gdGhpcyBwbHVnaW4pXG5cdFx0Ly8gVXNpbmcgdGhpcyBmdW5jdGlvbiB3aWxsIGF1dG9tYXRpY2FsbHkgcmVtb3ZlIHRoZSBldmVudCBsaXN0ZW5lciB3aGVuIHRoaXMgcGx1Z2luIGlzIGRpc2FibGVkLlxuXHRcdHRoaXMucmVnaXN0ZXJEb21FdmVudChkb2N1bWVudCwgXCJjbGlja1wiLCAoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7XG5cdFx0XHRjb25zb2xlLmxvZyhcImNsaWNrXCIsIGV2dCk7XG5cdFx0fSk7XG5cblx0XHQvLyBXaGVuIHJlZ2lzdGVyaW5nIGludGVydmFscywgdGhpcyBmdW5jdGlvbiB3aWxsIGF1dG9tYXRpY2FsbHkgY2xlYXIgdGhlIGludGVydmFsIHdoZW4gdGhlIHBsdWdpbiBpcyBkaXNhYmxlZC5cblx0XHR0aGlzLnJlZ2lzdGVySW50ZXJ2YWwoXG5cdFx0XHR3aW5kb3cuc2V0SW50ZXJ2YWwoKCkgPT4gY29uc29sZS5sb2coXCJzZXRJbnRlcnZhbFwiKSwgNSAqIDYwICogMTAwMClcblx0XHQpO1xuXHR9XG5cblx0b251bmxvYWQoKSB7fVxuXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcblx0XHR0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbihcblx0XHRcdHt9LFxuXHRcdFx0REVGQVVMVF9TRVRUSU5HUyxcblx0XHRcdGF3YWl0IHRoaXMubG9hZERhdGEoKVxuXHRcdCk7XG5cdH1cblxuXHRhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG5cdFx0YXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcblx0fVxufVxuXG5jbGFzcyBTYW1wbGVNb2RhbCBleHRlbmRzIE1vZGFsIHtcblx0Y29uc3RydWN0b3IoYXBwOiBBcHApIHtcblx0XHRzdXBlcihhcHApO1xuXHR9XG5cblx0b25PcGVuKCkge1xuXHRcdGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuXHRcdGNvbnRlbnRFbC5zZXRUZXh0KFwiV29haCFcIik7XG5cdH1cblxuXHRvbkNsb3NlKCkge1xuXHRcdGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuXHRcdGNvbnRlbnRFbC5lbXB0eSgpO1xuXHR9XG59XG5cbmNsYXNzIFNhbXBsZVNldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcblx0cGx1Z2luOiBMYW5QbHVnaW47XG5cblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogTGFuUGx1Z2luKSB7XG5cdFx0c3VwZXIoYXBwLCBwbHVnaW4pO1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHR9XG5cblx0ZGlzcGxheSgpOiB2b2lkIHtcblx0XHRjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXG5cdFx0Y29udGFpbmVyRWwuZW1wdHkoKTtcblxuXHRcdG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuXHRcdFx0LnNldE5hbWUoXCJTZXR0aW5nICMxXCIpXG5cdFx0XHQuc2V0RGVzYyhcIkl0J3MgYSBzZWNyZXRcIilcblx0XHRcdC5hZGRUZXh0KCh0ZXh0KSA9PlxuXHRcdFx0XHR0ZXh0XG5cdFx0XHRcdFx0LnNldFBsYWNlaG9sZGVyKFwiRW50ZXIgeW91ciBzZWNyZXRcIilcblx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubXlTZXR0aW5nKVxuXHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLm15U2V0dGluZyA9IHZhbHVlO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0fSlcblx0XHRcdCk7XG5cdH1cbn1cbiIsICJpbXBvcnQge1xuXHRFZGl0b3IsXG5cdE1hcmtkb3duVmlldyxcblx0QXBwLFxuXHRTZXR0aW5nLFxuXHRNb2RhbCxcblx0RnV6enlTdWdnZXN0TW9kYWwsXG5cdE5vdGljZSxcbiAgICBub3JtYWxpemVQYXRoLFxuICAgIFRGaWxlLFxuICAgIFRGb2xkZXIsXG59IGZyb20gXCJvYnNpZGlhblwiO1xuXG5pbXBvcnQgKiBhcyBwYXRoIGZyb20gXCJwYXRoXCI7XG5cbmltcG9ydCAqIGFzIGJpZ25vdGUgZnJvbSBcIi4vbm90ZWNsdXN0ZXJcIjtcblxuXG5pbXBvcnQgKiBhcyBjb21tIGZyb20gXCIuL2NvbW1vblwiO1xuXG5hc3luYyBmdW5jdGlvbiBydW5fd2l0aF91c2VyX2lucHV0KGVkaXRvcjogRWRpdG9yLCB2aWV3OiBNYXJrZG93blZpZXcsIG9wdF9zZWxlY3RlZF9iaWdub3RlX3Jvb3RfZm9sZGVyOiBURm9sZGVyIHwgdW5kZWZpbmVkLCBzZWxlY3RlZF9jb250ZXh0OiBzdHJpbmcsIG5ld19ub3RlX25hbWU6IHN0cmluZykge1xuICAgIGNvbnN0IG9wdF9zcGF3bmVyX2ZpbGUgPSB2aWV3LmZpbGU7XG4gICAgaWYgKCFvcHRfc3Bhd25lcl9maWxlKSB7XG4gICAgICAgIG5ldyBOb3RpY2UoYEVycm9yOiBQbGVhc2UgdXNlIHRoaXMgY29tbWFuZCBmcm9tIHdpdGhpbiBhIG5vdGUgdG8gc3Bhd24gZnJvbWApO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IHNwYXduZXJfZmlsZSA9IG9wdF9zcGF3bmVyX2ZpbGU7XG5cbiAgICBjb25zdCBzcGF3bmVyX2lzX2luZGV4ID0gYmlnbm90ZS5pc19jbHVzdGVyX3Jvb3RfZmlsZShzcGF3bmVyX2ZpbGUpO1xuXG4gICAgLy8gV2Ugb25seSByZXF1aXJlIGl0IGJlIGEgc21hbGwgbm90ZSBmaWxlIGlmIGl0J3Mgbm90IHNwYXduZWQgZnJvbSBvdXRzaWRlIG9yIHRoZSBpbmRleFxuICAgIGlmICghc3Bhd25lcl9pc19pbmRleCAmJiAhb3B0X3NlbGVjdGVkX2JpZ25vdGVfcm9vdF9mb2xkZXIgJiYgIWJpZ25vdGUuaXNfY2x1c3Rlcl9ub25faW5kZXhfZmlsZSh2aWV3LCBzcGF3bmVyX2ZpbGUpKSB7XG4gICAgICAgIG5ldyBOb3RpY2UoYEVycm9yOiBTcGF3bmVyIGZpbGUgaXMgbm90IGEgc21hbGwgbm90ZWApO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgdmFyIG9wdF9pbmRleF9maWxlOiBURmlsZSB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcblxuICAgIGlmIChzcGF3bmVyX2lzX2luZGV4KSB7XG4gICAgICAgIG9wdF9pbmRleF9maWxlID0gc3Bhd25lcl9maWxlO1xuICAgIH0gZWxzZSBpZiAob3B0X3NlbGVjdGVkX2JpZ25vdGVfcm9vdF9mb2xkZXIpIHtcbiAgICAgICAgb3B0X2luZGV4X2ZpbGUgPSBiaWdub3RlLmdldF9jbHVzdGVyX2NvcmVfZmlsZV9mcm9tX2NsdXN0ZXJfcm9vdF9mb2xkZXIob3B0X3NlbGVjdGVkX2JpZ25vdGVfcm9vdF9mb2xkZXIpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIG9wdF9pbmRleF9maWxlID0gYmlnbm90ZS5nZXRfY2x1c3Rlcl9jb3JlX2ZpbGVfZnJvbV9wZXJpcGhlcmFsKHZpZXcsIHNwYXduZXJfZmlsZSk7XG4gICAgfVxuXG4gICAgaWYgKCFvcHRfaW5kZXhfZmlsZSkge1xuICAgICAgICBuZXcgTm90aWNlKGBFcnJvcjogRmFpbGVkIHRvIHJldHJpZXZlIGluZGV4IGZpbGVgKTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBpbmRleF9maWxlID0gb3B0X2luZGV4X2ZpbGU7XG5cbiAgICBjb25zdCBvcHRfYmlnbm90ZV9yb290X2ZvbGRlciA9IGluZGV4X2ZpbGUucGFyZW50O1xuICAgIGlmICghb3B0X2JpZ25vdGVfcm9vdF9mb2xkZXIpIHtcbiAgICAgICAgbmV3IE5vdGljZShgRmFpbGVkIEFzc2VydGlvbjogaW5kZXggZmlsZSBoYXMgbm8gcGFyZW50YCk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgYmlnbm90ZV9yb290X2ZvbGRlciA9IG9wdF9iaWdub3RlX3Jvb3RfZm9sZGVyO1xuXG4gICAgY29uc3Qgb3B0X2NvbnRleHRfZm9sZGVyX25hbWUgPSBiaWdub3RlLmNvbnRleHRfdHlwZV9zaW5ndWxhcl9jb252ZXJ0KHNlbGVjdGVkX2NvbnRleHQsIGJpZ25vdGUuQ09OVEVYVF9UWVBFX0ZPTERFUlMpO1xuICAgIGlmICghb3B0X2NvbnRleHRfZm9sZGVyX25hbWUpIHtcbiAgICAgICAgbmV3IE5vdGljZShgRXJyb3I6IEZhaWxlZCB0byByZXRyaWV2ZSBjb250ZXh0IGZvbGRlcmApO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IGNvbnRleHRfZm9sZGVyX25hbWUgPSBvcHRfY29udGV4dF9mb2xkZXJfbmFtZTtcblxuICAgIGNvbnN0IG9wdF9jb250ZXh0X2Jsb2NrX2lkZW50aWZpZXJfY29kZSA9IGJpZ25vdGUuY29udGV4dF90eXBlX3Npbmd1bGFyX2NvbnZlcnQoc2VsZWN0ZWRfY29udGV4dCwgYmlnbm90ZS5DT05URVhUX1RZUEVfQkxPQ0tfSURFTlRJRklFUl9DT0RFKTtcbiAgICBpZiAoIW9wdF9jb250ZXh0X2Jsb2NrX2lkZW50aWZpZXJfY29kZSkge1xuICAgICAgICBuZXcgTm90aWNlKGBFcnJvcjogRmFpbGVkIHRvIHJldHJpZXZlIGNvbnRleHQgYmxvY2sgaWRlbnRpZmllciBjb2RlYCk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgY29udGV4dF9ibG9ja19pZGVudGlmaWVyX2NvZGUgPSBvcHRfY29udGV4dF9ibG9ja19pZGVudGlmaWVyX2NvZGU7XG5cbiAgICBjb25zdCBjb250ZXh0X2ZvbGRlcl9wYXRoID0gbm9ybWFsaXplUGF0aChwYXRoLmpvaW4oYmlnbm90ZV9yb290X2ZvbGRlci5wYXRoLCBjb250ZXh0X2ZvbGRlcl9uYW1lKSk7XG5cbiAgICBjb25zdCBmcyA9IHNwYXduZXJfZmlsZS52YXVsdC5hZGFwdGVyO1xuXG4gICAgY29uc29sZS5sb2coYGNvbnRleHRfZm9sZGVyX3BhdGg6ICR7Y29udGV4dF9mb2xkZXJfcGF0aH1gKTtcbiAgICBhd2FpdCBmcy5ta2Rpcihjb250ZXh0X2ZvbGRlcl9wYXRoKTtcblxuICAgIGNvbnN0IGlkNiA9IGNvbW0ubWFrZV9oZXhfaWQoNik7XG5cbiAgICBjb25zdCBvcHRfdHJpcGxldF9pZCA9IGJpZ25vdGUuZ2V0X25leHRfdHJpcGxldF9pZF9mb3JfZm9sZGVyKGNvbnRleHRfZm9sZGVyX25hbWUsIGluZGV4X2ZpbGUpO1xuICAgIGlmICghb3B0X3RyaXBsZXRfaWQpIHtcbiAgICAgICAgbmV3IE5vdGljZShgRXJyb3I6IEZhaWxlZCB0byBnZW5lcmF0ZSBuZXcgdHJpcGxldCBpZGApO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGNvbnN0IHRyaXBsZXRfaWQgPSBvcHRfdHJpcGxldF9pZDtcblxuICAgIGNvbnN0IG5ld19ub3RlX2Jhc2VuYW1lID0gYCR7dHJpcGxldF9pZH0gJHtuZXdfbm90ZV9uYW1lfWA7XG5cbiAgICBjb25zdCBibG9ja19pZGVudGlmaWVyID0gYF5zcGF3bi0ke2NvbnRleHRfYmxvY2tfaWRlbnRpZmllcl9jb2RlfS0ke2lkNn1gO1xuXG4gICAgY29tbS5pbnNlcnRfdGV4dF9hdF9lZGl0b3JfY3Vyc29yX2luX293bl9saW5lKGVkaXRvciwgYFNwYXduIFtbJHtuZXdfbm90ZV9iYXNlbmFtZX1dXSAke2Jsb2NrX2lkZW50aWZpZXJ9YCk7XG5cbiAgICBjb25zdCBuZXdfZmlsZV9wYXRoID0gbm9ybWFsaXplUGF0aChwYXRoLmpvaW4oY29udGV4dF9mb2xkZXJfcGF0aCwgbmV3X25vdGVfYmFzZW5hbWUgKyBcIi5tZFwiKSk7XG5cbiAgICBjb25zb2xlLmxvZyhgbmV3X2ZpbGVfcGF0aDogJHtuZXdfZmlsZV9wYXRofWApO1xuXG4gICAgLy8gV2UgYWRkIGEgXCJzdGF0dXM6IHRvZG9cIiBhdXRvbWF0aWNhbGx5IGZvciBhbGwgZG9lciBjb250ZXh0IHR5cGVzLlxuICAgIHZhciBhdXRvbWF0aWNfc3RhdHVzID0gXCJcIjtcbiAgICBpZiAoYmlnbm90ZS5jb250ZXh0X3R5cGVfaGVhZGluZ19zaW5ndWxhcl9pc19kb2VyKHNlbGVjdGVkX2NvbnRleHQpKSB7XG4gICAgICAgIGF1dG9tYXRpY19zdGF0dXMgPSBgc3RhdHVzOiB0b2RvXFxuYDtcbiAgICB9XG5cbiAgICB2YXIgY29udGV4dF90eXBlID0gc2VsZWN0ZWRfY29udGV4dC50b0xvd2VyQ2FzZSgpO1xuXG4gICAgYXdhaXQgZnMud3JpdGUobmV3X2ZpbGVfcGF0aCwgXG4gICAgICAgIGAtLS1cXG5gICtcbiAgICAgICAgYHBhcmVudDogXCJbWyR7aW5kZXhfZmlsZS5iYXNlbmFtZX1dXVwiXFxuYCArXG4gICAgICAgIGBzcGF3bmVkX2J5OiBcIltbJHtzcGF3bmVyX2ZpbGUuYmFzZW5hbWV9XV1cIlxcbmAgK1xuICAgICAgICBgY29udGV4dF90eXBlOiAke2NvbnRleHRfdHlwZX1cXG5gICsgXG4gICAgICAgIGF1dG9tYXRpY19zdGF0dXMgK1xuICAgICAgICBgLS0tXFxuXFxuYCArXG4gICAgICAgIGBQYXJlbnQ6IFtbJHtpbmRleF9maWxlLmJhc2VuYW1lfV1dXFxuXFxuYCArXG4gICAgICAgIGBTcGF3bmVkIGJ5OiBbWyR7c3Bhd25lcl9maWxlLmJhc2VuYW1lfV1dIFxcblxcbmAgK1xuICAgICAgICBgU3Bhd25lZCBpbjogW1ske3NwYXduZXJfZmlsZS5iYXNlbmFtZX0jJHtibG9ja19pZGVudGlmaWVyfXwke2Jsb2NrX2lkZW50aWZpZXJ9XV1cXG5cXG5gICtcbiAgICAgICAgYCMgSm91cm5hbGBcbiAgICApO1xufVxuXG5leHBvcnQgY2xhc3MgSW5wdXROb3RlTmFtZU1vZGFsIGV4dGVuZHMgTW9kYWwge1xuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgb25TdWJtaXQ6IChyZXN1bHQ6IHN0cmluZykgPT4gdm9pZCkge1xuXHRcdHN1cGVyKGFwcCk7XG5cdFx0dGhpcy5zZXRUaXRsZShcIk5ldyBOb3RlIE5hbWUgKHdpdGhvdXQgTk5OIElEKVwiKTtcblxuXHRcdGxldCBuYW1lID0gXCJcIjtcblxuXHRcdG5ldyBTZXR0aW5nKHRoaXMuY29udGVudEVsKS5zZXROYW1lKFwiTmV3IE5vdGUgTmFtZVwiKS5hZGRUZXh0KCh0ZXh0KSA9PlxuXHRcdFx0dGV4dC5vbkNoYW5nZSgodmFsdWUpID0+IHtcblx0XHRcdFx0bmFtZSA9IHZhbHVlO1xuXHRcdFx0fSlcblx0XHQpO1xuXG5cdFx0bmV3IFNldHRpbmcodGhpcy5jb250ZW50RWwpLmFkZEJ1dHRvbigoYnRuKSA9PlxuXHRcdFx0YnRuXG5cdFx0XHRcdC5zZXRCdXR0b25UZXh0KFwiU3VibWl0XCIpXG5cdFx0XHRcdC5zZXRDdGEoKVxuXHRcdFx0XHQub25DbGljaygoKSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5jbG9zZSgpO1xuXHRcdFx0XHRcdG9uU3VibWl0KG5hbWUpO1xuXHRcdFx0XHR9KVxuXHRcdCk7XG5cdH1cbn1cblxuZXhwb3J0IGNsYXNzIFNlbGVjdENvbnRleHRUeXBlTW9kYWwgZXh0ZW5kcyBGdXp6eVN1Z2dlc3RNb2RhbDxzdHJpbmc+IHtcbiAgICBlZGl0b3I6IEVkaXRvcjtcbiAgICB2aWV3OiBNYXJrZG93blZpZXc7XG4gICAgb3B0X3NlbGVjdGVkX2JpZ25vdGVfcm9vdF9mb2xkZXI6IFRGb2xkZXIgfCB1bmRlZmluZWQ7XG5cblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIGVkaXRvcjogRWRpdG9yLCB2aWV3OiBNYXJrZG93blZpZXcsIG9wdF9zZWxlY3RlZF9pbmRleF9mb2xkZXI6IFRGb2xkZXIgfCB1bmRlZmluZWQpIHtcbiAgICAgICAgc3VwZXIoYXBwKVxuICAgICAgICB0aGlzLmVkaXRvciA9IGVkaXRvcjtcbiAgICAgICAgdGhpcy52aWV3ID0gdmlldztcbiAgICAgICAgdGhpcy5vcHRfc2VsZWN0ZWRfYmlnbm90ZV9yb290X2ZvbGRlciA9IG9wdF9zZWxlY3RlZF9pbmRleF9mb2xkZXI7XG4gICAgfVxuXG5cdGdldEl0ZW1zKCk6IHN0cmluZ1tdIHtcblx0XHRyZXR1cm4gYmlnbm90ZS5DT05URVhUX1RZUEVfSEVBRElOR1NfU0lOR1VMQVI7XG5cdH1cblxuXHRnZXRJdGVtVGV4dChpdGVtOiBzdHJpbmcpOiBzdHJpbmcge1xuXHRcdHJldHVybiBpdGVtO1xuXHR9XG5cblx0b25DaG9vc2VJdGVtKGl0ZW06IHN0cmluZywgZXZ0OiBNb3VzZUV2ZW50IHwgS2V5Ym9hcmRFdmVudCkge1xuXHRcdG5ldyBJbnB1dE5vdGVOYW1lTW9kYWwodGhpcy5hcHAsIChyZXN1bHQpID0+IHtcbiAgICAgICAgICAgIHJ1bl93aXRoX3VzZXJfaW5wdXQodGhpcy5lZGl0b3IsIHRoaXMudmlldywgdGhpcy5vcHRfc2VsZWN0ZWRfYmlnbm90ZV9yb290X2ZvbGRlciwgaXRlbSwgcmVzdWx0KTtcblx0XHR9KS5vcGVuKCk7XG5cdH1cbn1cblxuZXhwb3J0IGNsYXNzIFNlbGVjdEJpZ25vdGVSb290Rm9sZGVyTW9kYWwgZXh0ZW5kcyBGdXp6eVN1Z2dlc3RNb2RhbDxURm9sZGVyPiB7XG4gICAgZWRpdG9yOiBFZGl0b3I7XG4gICAgdmlldzogTWFya2Rvd25WaWV3O1xuXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBlZGl0b3I6IEVkaXRvciwgdmlldzogTWFya2Rvd25WaWV3KSB7XG4gICAgICAgIHN1cGVyKGFwcClcbiAgICAgICAgdGhpcy5lZGl0b3IgPSBlZGl0b3I7XG4gICAgICAgIHRoaXMudmlldyA9IHZpZXc7XG4gICAgfVxuXG5cdGdldEl0ZW1zKCk6IFRGb2xkZXJbXSB7XG5cdFx0cmV0dXJuIGJpZ25vdGUuZ2V0X2FsbF9pbmRleF9mb2xkZXJzX2luX3ZhdWx0KHRoaXMudmlldyk7XG5cdH1cblxuXHRnZXRJdGVtVGV4dChpdGVtOiBURm9sZGVyKTogc3RyaW5nIHtcblx0XHRyZXR1cm4gaXRlbS5uYW1lO1xuXHR9XG5cblx0b25DaG9vc2VJdGVtKGl0ZW06IFRGb2xkZXIsIGV2dDogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnQpIHtcbiAgICAgICAgbmV3IFNlbGVjdENvbnRleHRUeXBlTW9kYWwodGhpcy52aWV3LmFwcCwgdGhpcy5lZGl0b3IsIHRoaXMudmlldywgLypvcHRfc2VsZWN0ZWRfYmlnbm90ZV9yb290X2ZvbGRlciovIGl0ZW0pLm9wZW4oKTtcblx0fVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcnVuKGVkaXRvcjogRWRpdG9yLCB2aWV3OiBNYXJrZG93blZpZXcpIHtcblx0bmV3IFNlbGVjdENvbnRleHRUeXBlTW9kYWwodmlldy5hcHAsIGVkaXRvciwgdmlldywgLypvcHRfc2VsZWN0ZWRfYmlnbm90ZV9yb290X2ZvbGRlciovIHVuZGVmaW5lZCkub3BlbigpO1xufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcnVuX2Zyb21fb3V0c2lkZShlZGl0b3I6IEVkaXRvciwgdmlldzogTWFya2Rvd25WaWV3KSB7XG4gICAgbmV3IFNlbGVjdEJpZ25vdGVSb290Rm9sZGVyTW9kYWwodmlldy5hcHAsIGVkaXRvciwgdmlldykub3BlbigpO1xufVxuXG4iLCAiaW1wb3J0IHsgTWFya2Rvd25WaWV3LCBURmlsZSwgVEZvbGRlciB9IGZyb20gXCJvYnNpZGlhblwiO1xuXG5pbXBvcnQgKiBhcyBjb21tIGZyb20gXCIuL2NvbW1vblwiO1xuXG5leHBvcnQgY29uc3QgQ09OVEVYVF9UWVBFX0ZPTERFUlMgPSBbXG5cdFwiZW50cmllc1wiLFxuXHRcImhvd3Rvc1wiLFxuXHRcImlkZWFzXCIsXG5cdFwiaW5mZXJlbmNlc1wiLFxuXHRcImludmVzdGlnYXRpb25zXCIsXG5cdFwiaXNzdWVzXCIsXG5cdFwidGFza3NcIixcbl07XG5cbmV4cG9ydCBjb25zdCBDT05URVhUX1RZUEVfQkxPQ0tfSURFTlRJRklFUl9DT0RFID0gW1xuXHRcImVudHJ5XCIsXG5cdFwiaG93dG9cIixcblx0XCJpZGVhXCIsXG5cdFwiaW5mZXJcIixcblx0XCJpbnZzdFwiLFxuXHRcImlzc3VlXCIsXG5cdFwidGFza1wiLFxuXTtcblxuZXhwb3J0IGNvbnN0IENPTlRFWFRfVFlQRV9IRUFESU5HU19TSU5HVUxBUiA9IFtcblx0XCJFbnRyeVwiLFxuXHRcIkhvd1RvXCIsXG5cdFwiSWRlYVwiLFxuXHRcIkluZmVyZW5jZVwiLFxuXHRcIkludmVzdGlnYXRpb25cIixcblx0XCJJc3N1ZVwiLFxuXHRcIlRhc2tcIixcbl07XG5cblxuZXhwb3J0IGNvbnN0IENPTlRFWFRfVFlQRV9IRUFESU5HUyA9IFtcblx0XCJFbnRyaWVzXCIsXG5cdFwiSG93VG9zXCIsXG5cdFwiSWRlYXNcIixcblx0XCJJbmZlcmVuY2VzXCIsXG5cdFwiSW52ZXN0aWdhdGlvbnNcIixcblx0XCJJc3N1ZXNcIixcblx0XCJUYXNrc1wiLFxuXTtcblxuZXhwb3J0IGZ1bmN0aW9uIGNvbnRleHRfdHlwZV9zaW5ndWxhcl9jb252ZXJ0KFxuXHRjb250ZXh0X3R5cGU6IHN0cmluZyxcbiAgICBuZXdfdHlwZV9zdHJpbmdzOiBzdHJpbmdbXVxuKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcblx0Y29uc3QgaW5kZXggPSBDT05URVhUX1RZUEVfSEVBRElOR1NfU0lOR1VMQVIuZmluZEluZGV4KChlbGVtKSA9PiBlbGVtID09PSBjb250ZXh0X3R5cGUpO1xuXHRpZiAoaW5kZXggPT0gLTEpIHtcblx0XHRyZXR1cm4gdW5kZWZpbmVkO1xuXHR9XG5cblx0aWYgKGluZGV4IDwgMCB8fCBpbmRleCA+PSBuZXdfdHlwZV9zdHJpbmdzLmxlbmd0aCkge1xuXHRcdGNvbnNvbGUubG9nKFxuXHRcdFx0YEVycm9yOiBVbmV4cGVjdGVkIHZhbHVlIGZvciAke2luZGV4fSBmb3IgY29udGV4dCB0eXBlIGxvb2t1cGBcblx0XHQpO1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuXHR9XG5cblx0cmV0dXJuIG5ld190eXBlX3N0cmluZ3NbaW5kZXhdO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY29udGV4dF90eXBlX2hlYWRpbmdfc2luZ3VsYXJfaXNfZG9lcihoZWFkaW5nOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICBjb25zdCBkb2VycyA9IFtcbiAgICAgICAgLy8gXCJFbnRyeVwiLFxuICAgICAgICBcIkhvd1RvXCIsXG4gICAgICAgIC8vIFwiSWRlYVwiLFxuICAgICAgICAvLyBcIkluZmVyZW5jZVwiLFxuICAgICAgICBcIkludmVzdGlnYXRpb25cIixcbiAgICAgICAgXCJJc3N1ZVwiLFxuICAgICAgICBcIlRhc2tcIixcbiAgICBdO1xuXG4gICAgcmV0dXJuIGRvZXJzLmNvbnRhaW5zKGhlYWRpbmcpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZm9sZGVyX2hhc19ub3RlX29mX3NhbWVfbmFtZShmb2xkZXI6IFRGb2xkZXIpOiBib29sZWFuIHtcblx0Zm9yICh2YXIgaSA9IDA7IGkgPCBmb2xkZXIuY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcblx0XHRjb25zdCBjaGlsZCA9IGZvbGRlci5jaGlsZHJlbltpXTtcblxuXHRcdGlmIChjaGlsZCBpbnN0YW5jZW9mIFRGaWxlKSB7XG5cdFx0XHRpZiAoZm9sZGVyLm5hbWUgPT0gY2hpbGQuYmFzZW5hbWUpIHtcblx0XHRcdFx0cmV0dXJuIHRydWU7XG5cdFx0XHR9XG5cdFx0fVxuXHR9XG5cblx0cmV0dXJuIGZhbHNlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaXNfY2x1c3Rlcl9yb290X2ZvbGRlcihmb2xkZXI6IFRGb2xkZXIpOiBib29sZWFuIHtcblx0aWYgKFxuXHRcdCFmb2xkZXJfaGFzX25vdGVfb2Zfc2FtZV9uYW1lKGZvbGRlcikgfHxcblx0XHRjb21tLmdldF9mb2xkZXJfY2hpbGRfZmlsZV9jb3VudF9ub25fcmVjdXJzaXZlKGZvbGRlcikgIT0gMVxuXHQpIHtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblxuXHRyZXR1cm4gdHJ1ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzX2NsdXN0ZXJfY2F0ZWdvcnlfZm9sZGVyKGZvbGRlcjogVEZvbGRlcik6IGJvb2xlYW4ge1xuXHRpZiAoIUNPTlRFWFRfVFlQRV9GT0xERVJTLmluY2x1ZGVzKGZvbGRlci5uYW1lKSkge1xuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXG5cdGNvbnN0IG9wdF9wYXJlbnQgPSBmb2xkZXIucGFyZW50O1xuXHRpZiAoIW9wdF9wYXJlbnQpIHtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblx0Y29uc3QgcGFyZW50ID0gb3B0X3BhcmVudDtcblxuXHRpZiAoIWlzX2NsdXN0ZXJfcm9vdF9mb2xkZXIocGFyZW50KSkge1xuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXG5cdHJldHVybiB0cnVlO1xufVxuXG4vLy8gQ2hlY2tzIHRoYXQgdGhlIGdpdmVuIGZpbGUgY29tcGxpZXMgd2l0aCB0aGUgZXhwZWN0ZWQgZm9sZGVyIHN0cnVjdHVyZS5cbi8vLyBhbmQgaXMgaXRzIHJvb3QgZmlsZS5cbi8vLyBTZWUgXmNvbmNlcHQtY2x1c3Rlci1yb290LWZvbGRlci1zdHJ1Y3R1cmUgaW4gZG9jcy9zcGVjLm1kXG5leHBvcnQgZnVuY3Rpb24gaXNfY2x1c3Rlcl9yb290X2ZpbGUoZmlsZTogVEZpbGUpOiBib29sZWFuIHtcblx0Y29uc3Qgb3B0X3BhcmVudCA9IGZpbGUucGFyZW50O1xuXHRpZiAoIW9wdF9wYXJlbnQpIHtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblx0Y29uc3QgcGFyZW50ID0gb3B0X3BhcmVudDtcblxuXHRpZiAoIWlzX2NsdXN0ZXJfcm9vdF9mb2xkZXIocGFyZW50KSkge1xuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXG5cdGlmIChwYXJlbnQubmFtZSAhPSBmaWxlLmJhc2VuYW1lKSB7XG5cdFx0cmV0dXJuIGZhbHNlO1xuXHR9XG5cblx0cmV0dXJuIHRydWU7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRfY2x1c3Rlcl9jb3JlX2ZpbGVfZnJvbV9wZXJpcGhlcmFsKFxuXHR2aWV3OiBNYXJrZG93blZpZXcsXG5cdHBlcmlwaGVyYWxfZmlsZTogVEZpbGVcbik6IFRGaWxlIHwgdW5kZWZpbmVkIHtcblx0Y29uc3Qgb3B0X3BhcmVudF9maWxlID0gY29tbS5nZXRfZmlsZV9mcm9udG1hdHRlcl9ub3RlX3Byb3BlcnR5KFxuXHRcdHZpZXcsXG5cdFx0cGVyaXBoZXJhbF9maWxlLFxuXHRcdFwicGFyZW50XCJcblx0KTtcblx0aWYgKCFvcHRfcGFyZW50X2ZpbGUpIHtcbiAgICAgICAgY29uc29sZS5sb2coYEVycm9yOiBDb3VsZCBub3QgcmV0cmlldmUgZnJvbnRtYXR0ZXIgbm90ZSBwcm9wZXJ0eSBwYXJlbnQgZm9yICR7cGVyaXBoZXJhbF9maWxlLm5hbWV9YCk7XG5cdFx0cmV0dXJuIHVuZGVmaW5lZDtcblx0fVxuXHRjb25zdCBwYXJlbnRfZmlsZSA9IG9wdF9wYXJlbnRfZmlsZTtcblxuXHRpZiAoIWlzX2NsdXN0ZXJfcm9vdF9maWxlKHBhcmVudF9maWxlKSkge1xuICAgICAgICBjb25zb2xlLmxvZyhgRXJyb3I6ICR7cGFyZW50X2ZpbGUubmFtZX0gaXMgbm90IGEgYmlnbm90ZSBpbmRleCBmaWxlYCk7XG5cdFx0cmV0dXJuIHVuZGVmaW5lZDtcblx0fVxuXG5cdHJldHVybiBwYXJlbnRfZmlsZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldF9jbHVzdGVyX2NvcmVfZmlsZV9mcm9tX2NsdXN0ZXJfcm9vdF9mb2xkZXIoZm9sZGVyOiBURm9sZGVyKTogVEZpbGUgfCB1bmRlZmluZWQge1xuICAgIGlmICghaXNfY2x1c3Rlcl9yb290X2ZvbGRlcihmb2xkZXIpKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGBFcnJvcjogRXhwZWN0ZWQgJHtmb2xkZXIubmFtZX0gdG8gYmUgYSBiaWdub3RlIHJvb3QgZm9sZGVyYCk7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgZm9yICh2YXIgaT0wOyBpPGZvbGRlci5jaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuICAgICAgICBjb25zdCBjaGlsZCA9IGZvbGRlci5jaGlsZHJlbltpXTtcblxuICAgICAgICBpZiAoY2hpbGQgaW5zdGFuY2VvZiBURmlsZSAmJiBjaGlsZC5iYXNlbmFtZSA9PSBmb2xkZXIubmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuIGNoaWxkO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coYEFzc2VydGlvbiBGYWlsZWQ6IE5vIGluZGV4IGZpbGUgZm91bmQgaW4gYmlnbm90ZSByb290IGZvbGRlcmApO1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG59XG5cbi8vLyBDaGVja3MgdGhhdCB0aGUgZ2l2ZW4gZmlsZSBjb21wbGllcyB3aXRoIHRoZSBleHBlY3RlZCBmb2xkZXIgc3RydWN0dXJlLlxuLy8vIGFuZCBpcyBhIHNtYWxsIG5vdGUgaW4gaXQsIHNvIGl0IGNvbXBsaWVzIHdpdGggXmNvbmNlcHQtc21hbGwtbm90ZS1jb250ZW50LXJlcXVpcmVtZW50c1xuZXhwb3J0IGZ1bmN0aW9uIGlzX2NsdXN0ZXJfbm9uX2luZGV4X2ZpbGUoXG5cdHZpZXc6IE1hcmtkb3duVmlldyxcblx0ZmlsZTogVEZpbGVcbik6IGJvb2xlYW4ge1xuXHRjb25zdCBvcHRfcGFyZW50ID0gZmlsZS5wYXJlbnQ7XG5cdGlmICghb3B0X3BhcmVudCkge1xuICAgICAgICBjb25zb2xlLmxvZyhgRXJyb3I6IEZhaWxlZCB0byByZXRyaWV2ZSBwYXJlbnQgZm9sZGVyIGZvciAke2ZpbGUubmFtZX1gKTtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblx0Y29uc3QgcGFyZW50X2ZvbGRlciA9IG9wdF9wYXJlbnQ7XG5cblx0aWYgKCFpc19jbHVzdGVyX2NhdGVnb3J5X2ZvbGRlcihwYXJlbnRfZm9sZGVyKSkge1xuICAgICAgICBjb25zb2xlLmxvZyhgRXJyb3I6ICR7cGFyZW50X2ZvbGRlci5uYW1lfSBpcyBub3QgYSBiaWdub3RlIGNhdGVnb3J5IGZvbGRlcmApO1xuXHRcdHJldHVybiBmYWxzZTtcblx0fVxuXG5cdGNvbnN0IG9wdF9wYXJlbnRfZmlsZSA9IGdldF9jbHVzdGVyX2NvcmVfZmlsZV9mcm9tX3BlcmlwaGVyYWwodmlldywgZmlsZSk7XG5cdGlmICghb3B0X3BhcmVudF9maWxlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGBFcnJvcjogQ291bGQgbm90IGdldCBiaWcgbm90ZSBpbmRleCBmaWxlIGZvciAke2ZpbGUubmFtZX1gKTtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblx0Y29uc3QgcGFyZW50X2ZpbGUgPSBvcHRfcGFyZW50X2ZpbGU7XG5cblx0Y29uc3Qgb3B0X2dyYW5kcGFyZW50X2ZvbGRlciA9IHBhcmVudF9mb2xkZXIucGFyZW50O1xuXHRpZiAoIW9wdF9ncmFuZHBhcmVudF9mb2xkZXIpIHtcbiAgICAgICAgY29uc29sZS5sb2coYEVycm9yOiBDb3VsZCBub3QgZ2V0IGdyYW5kcGFyZW50IGZvciAke2ZpbGUubmFtZX1gKTtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblx0Y29uc3QgZ3JhbmRwYXJlbnRfZm9sZGVyID0gb3B0X2dyYW5kcGFyZW50X2ZvbGRlcjtcblxuXHRpZiAoZ3JhbmRwYXJlbnRfZm9sZGVyICE9IHBhcmVudF9maWxlLnBhcmVudCkge1xuICAgICAgICBjb25zb2xlLmxvZyhgRXJyb3I6IEV4cGVjdGVkIGdyYW5kcGFyZW50ICR7Z3JhbmRwYXJlbnRfZm9sZGVyLm5hbWV9IHRvIGJlIGlkZW50aWNhbCB0byBwYXJlbnQgZm9sZGVyIG9mICR7cGFyZW50X2ZpbGUucGF0aH1gKTtcblx0XHRyZXR1cm4gZmFsc2U7XG5cdH1cblxuXHRyZXR1cm4gdHJ1ZTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGRpc3BsYXlfdHJpcGxldF9pZChpZDogbnVtYmVyKTogc3RyaW5nICB7XG4gICAgaWYgKGlkIDwgMTApIHtcbiAgICAgICAgcmV0dXJuIFwiMDBcIiArIGlkLnRvU3RyaW5nKCk7XG4gICAgfSBlbHNlIGlmIChpZCA8IDEwMCkge1xuICAgICAgICByZXR1cm4gXCIwXCIgKyBpZC50b1N0cmluZygpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBpZC50b1N0cmluZygpO1xuICAgIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldF9uZXh0X3RyaXBsZXRfaWRfZm9yX2ZvbGRlcihcblx0Y29udGV4dF9mb2xkZXJfbmFtZTogc3RyaW5nLFxuXHRpbmRleF9maWxlOiBURmlsZVxuKTogc3RyaW5nIHwgdW5kZWZpbmVkIHtcblx0aWYgKCFDT05URVhUX1RZUEVfRk9MREVSUy5pbmNsdWRlcyhjb250ZXh0X2ZvbGRlcl9uYW1lKSkge1xuXHRcdHJldHVybiB1bmRlZmluZWQ7XG5cdH1cblxuICAgIGNvbnN0IG9wdF9iaWdub3RlX3Jvb3RfZm9sZGVyID0gaW5kZXhfZmlsZS5wYXJlbnQ7XG4gICAgaWYgKCFvcHRfYmlnbm90ZV9yb290X2ZvbGRlcikge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBjb25zdCBiaWdub3RlX3Jvb3RfZm9sZGVyID0gb3B0X2JpZ25vdGVfcm9vdF9mb2xkZXI7XG5cbiAgICBjb25zdCBvcHRfY29udGV4dF9mb2xkZXIgPSBjb21tLmdldF9jaGlsZF9mb2xkZXJfYnlfbmFtZShiaWdub3RlX3Jvb3RfZm9sZGVyLCBjb250ZXh0X2ZvbGRlcl9uYW1lKTtcbiAgICBpZiAoIW9wdF9jb250ZXh0X2ZvbGRlcikge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBjb25zdCBjb250ZXh0X2ZvbGRlciA9IG9wdF9jb250ZXh0X2ZvbGRlcjtcblxuICAgIGNvbnN0IG51bV9maWxlc19pbl9jb250ZXh0X2ZvbGRlciA9IGNvbW0uZ2V0X2ZvbGRlcl9jaGlsZF9maWxlX2NvdW50X25vbl9yZWN1cnNpdmUoY29udGV4dF9mb2xkZXIpO1xuXG4gICAgcmV0dXJuIGRpc3BsYXlfdHJpcGxldF9pZChudW1fZmlsZXNfaW5fY29udGV4dF9mb2xkZXIpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZ2V0X2FsbF9pbmRleF9mb2xkZXJzX2luX3ZhdWx0KHZpZXc6IE1hcmtkb3duVmlldyk6IFRGb2xkZXJbXSB7XG4gICAgY29uc3QgZm9sZGVycyA9IHZpZXcuYXBwLnZhdWx0LmdldEFsbEZvbGRlcnMoZmFsc2UpXG4gICAgICAgIC5maWx0ZXIoKGZvbGRlcikgPT4gaXNfY2x1c3Rlcl9yb290X2ZvbGRlcihmb2xkZXIpKTtcblxuICAgIHJldHVybiBmb2xkZXJzO1xufSIsICJpbXBvcnQge1xuXHRFZGl0b3IsXG4gICAgRnJvbnRNYXR0ZXJDYWNoZSxcbiAgICBNYXJrZG93blZpZXcsXG4gICAgVEZpbGUsXG4gICAgVEZvbGRlcixcbn0gZnJvbSBcIm9ic2lkaWFuXCI7XG5cbi8vLyBTaW1pbGFyIHRvIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vYS8xMzQ5NDI2LzY5NDQ0NDdcbmV4cG9ydCBmdW5jdGlvbiBtYWtlX2hleF9pZChsZW5ndGg6IG51bWJlcikge1xuICAgIHZhciByZXN1bHQgICAgICAgICAgID0gJyc7XG4gICAgdmFyIGNoYXJhY3RlcnMgICAgICAgPSAnYWJjZGVmMDEyMzQ1Njc4OSc7XG4gICAgdmFyIGNoYXJhY3RlcnNMZW5ndGggPSBjaGFyYWN0ZXJzLmxlbmd0aDtcbiAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKyApIHtcbiAgICAgICAgcmVzdWx0ICs9IGNoYXJhY3RlcnMuY2hhckF0KE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGNoYXJhY3RlcnNMZW5ndGgpKTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLy8vIEdldHMgYSBmcm9udG1hdHRlciBwcm9wZXJ0eSB0aGF0IHBvaW50cyB0byBhIGZpbGUgaWYgZm91bmRcbmV4cG9ydCBmdW5jdGlvbiBnZXRfZmlsZV9mcm9udG1hdHRlcl9ub3RlX3Byb3BlcnR5KHZpZXc6IE1hcmtkb3duVmlldywgZmlsZTogVEZpbGUsIHByb3A6IHN0cmluZyk6IFRGaWxlIHwgdW5kZWZpbmVkIHtcblxuICAgIGNvbnN0IG9wdF9jYWNoZSA9IHZpZXcuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpO1xuICAgIGlmICghb3B0X2NhY2hlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGBFcnJvcjogQ291bGQgbm90IHJldHJpZXZlIGZpbGUgY2FjaGUgZm9yICR7ZmlsZS5uYW1lfWApO1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBjb25zdCBjYWNoZSA9IG9wdF9jYWNoZTtcblxuICAgIGNvbnN0IG9wdF9mcm9udG1hdHRlciA9IGNhY2hlLmZyb250bWF0dGVyO1xuICAgIGlmICghb3B0X2Zyb250bWF0dGVyKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGBFcnJvcjogQ291bGQgbm90IHJldHJpZXZlIGZyb250bWF0dGVyIGZvciAke2ZpbGUubmFtZX1gKTtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgY29uc3QgZnJvbnRtYXR0ZXI6IEZyb250TWF0dGVyQ2FjaGUgPSBvcHRfZnJvbnRtYXR0ZXI7XG5cbiAgICAvLyB0aGlzIHZhbHVlIGNvdWxkIGJlIGFueXRoaW5nIGJ1dCB3ZSBleHBlY3QgYSBzdHJpbmdcbiAgICBjb25zdCBvcHRfdmFsdWU6IHN0cmluZyB8IHVuZGVmaW5lZCA9IGZyb250bWF0dGVyW3Byb3BdO1xuICAgIGlmICghb3B0X3ZhbHVlKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGBFcnJvcjogQ291bGQgbm90IHJldHJpZXZlIGZyb250bWF0dGVyIHByb3BlcnR5ICR7cHJvcH0gZm9yICR7ZmlsZS5uYW1lfWApO1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBjb25zdCB2YWx1ZSA9IG9wdF92YWx1ZS5yZXBsYWNlKFwiW1tcIiwgXCJcIikucmVwbGFjZShcIl1dXCIsIFwiXCIpO1xuXG4gICAgY29uc3Qgb3B0X2xpbmtlZF9maWxlID0gZmlsZS52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCkuZmluZChmID0+IGYuYmFzZW5hbWUgPT09IHZhbHVlKTtcbiAgICBpZiAoIW9wdF9saW5rZWRfZmlsZSkge1xuICAgICAgICBjb25zb2xlLmxvZyhgRXJyb3I6IENvdWxkIG5vdCBmaW5kIGZpbGUgZm9yIGxpbmsgJHt2YWx1ZX1gKTtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICByZXR1cm4gb3B0X2xpbmtlZF9maWxlO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gaW5zZXJ0X3RleHRfYXRfZWRpdG9yX2N1cnNvcl9pbl9vd25fbGluZShlZGl0b3I6IEVkaXRvciwgdGV4dDogc3RyaW5nKSB7XG4gICAgY29uc3QgY3Vyc29yID0gZWRpdG9yLmdldEN1cnNvcigpO1xuXG4gICAgZWRpdG9yLnJlcGxhY2VSYW5nZShcIlxcblwiICsgdGV4dCArIFwiXFxuXCIsIGN1cnNvcik7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBnZXRfY2hpbGRfZm9sZGVyX2J5X25hbWUoZm9sZGVyOiBURm9sZGVyLCBjaGlsZF9uYW1lOiBzdHJpbmcpOiBURm9sZGVyIHwgdW5kZWZpbmVkIHtcbiAgICBmb3IgKHZhciBpPTA7IGk8Zm9sZGVyLmNoaWxkcmVuLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGNvbnN0IGNoaWxkID0gZm9sZGVyLmNoaWxkcmVuW2ldO1xuXG4gICAgICAgIGlmIChjaGlsZCBpbnN0YW5jZW9mIFRGb2xkZXIgJiYgY2hpbGQubmFtZSA9PT0gY2hpbGRfbmFtZSkge1xuICAgICAgICAgICAgcmV0dXJuIGNoaWxkO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldF9mb2xkZXJfY2hpbGRfZmlsZV9jb3VudF9ub25fcmVjdXJzaXZlKGZvbGRlcjogVEZvbGRlcik6IG51bWJlciB7XG4gICAgdmFyIGNvdW50ID0gMDtcblxuICAgIGZvciAodmFyIGk9MDsgaTxmb2xkZXIuY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29uc3QgY2hpbGQgPSBmb2xkZXIuY2hpbGRyZW5baV07XG4gICAgICAgIGlmIChjaGlsZCBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgICAgICAgICBjb3VudCsrO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGNvdW50O1xufSJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUEsSUFBQUEsbUJBU087OztBQ1RQLElBQUFDLG1CQVdPO0FBRVAsV0FBc0I7OztBQ2J0QixJQUFBQyxtQkFBNkM7OztBQ0E3QyxzQkFNTztBQUdBLFNBQVMsWUFBWSxRQUFnQjtBQUN4QyxNQUFJLFNBQW1CO0FBQ3ZCLE1BQUksYUFBbUI7QUFDdkIsTUFBSSxtQkFBbUIsV0FBVztBQUNsQyxXQUFVLElB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QjtBQUFBLEVBRy9DLFlBQVksS0FBVSxRQUFtQjtBQUN4QyxVQUFNLEtBQUssTUFBTTtBQUNqQixTQUFLLFNBQVM7QUFBQSxFQUNmO0FBQUEsRUFFQSxVQUFnQjtBQUNmLFVBQU0sRUFBRSxZQUFZLElBQUk7QUFFeEIsZ0JBQVksTUFBTTtBQUVsQixRQUFJLHlCQUFRLFdBQVcsRUFDckIsUUFBUSxZQUFZLEVBQ3BCLFFBQVEsZUFBZSxFQUN2QjtBQUFBLE1BQVEsQ0FBQyxTQUNULEtBQ0UsZUFBZSxtQkFBbUIsRUFDbEMsU0FBUyxLQUFLLE9BQU8sU0FBUyxTQUFTLEVBQ3ZDLFNBQVMsT0FBTyxVQUFVO0FBQzFCLGFBQUssT0FBTyxTQUFTLFlBQVk7QUFDakMsY0FBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLE1BQ2hDLENBQUM7QUFBQSxJQUNIO0FBQUEsRUFDRjtBQUNEOyIsCiAgIm5hbWVzIjogWyJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiJdCn0K
